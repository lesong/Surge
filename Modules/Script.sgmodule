#!name=lesongè‡ªç”¨è„šæœ¬ 
#!desc=æœ€åæ›´æ–°æ—¶é—´ 2022-05-09 08:06:06
[General]
doh-server = %APPEND% https://doh.pub/dns-query

[Panel]
timecard = script-name=timecard,update-interval=3600
# > æµåª’ä½“è§£é”æ£€æµ‹
stream-all = script-name=stream-all, title="æµåª’ä½“è§£é”æ£€æµ‹", content="è¯·åˆ·æ–°é¢æ¿", update-interval=-1
# > åˆ·æ–°DNSç¼“å­˜
flushDNS = script-name=flushDNS,title="Flush DNS",content="è¯·åˆ·æ–°",update-interval=600

[Script]
# > æµåª’ä½“è§£é”æ£€æµ‹
timecard = type=generic,timeout=10,script-path=https://raw.githubusercontent.com/smartmimi/conf/master/surge/timecard.js
stream-all = type=generic, timeout=15, script-path= https://raw.githubusercontent.com/leohaol/Surge/main/Script/Stream-all.js

# > åˆ·æ–°DNSç¼“å­˜
flushDNS = type=generic,timeout=5,script-path=https://raw.githubusercontent.com/zZPiglet/Task/master/asset/flushDNS.js,argument=title=DNS FLush&icon=arrow.clockwise&color=#3d3d5b

# > ç™¾åº¦æœç´¢é˜²è·³è½¬ App Store(boxer.baidu.com)
baidu-no-redirect.js = type=http-response,pattern=^https?:\/\/boxer\.baidu\.com\/scheme\?scheme,script-path=https://raw.githubusercontent.com/app2smile/rules/master/js/baidu-no-redirect.js

# > è‹¹æœå¤©æ°”ç›¸å…³(weather-data.apple.com, weather-map.apple.com)
Apple Weather Availability = type=http-response, pattern=^https?:\/\/weather-data\.apple\.com\/(v1|v2)\/availability\/.*, requires-body=1, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Weather.Availability.js, argument=
Apple Weather = type=http-response, pattern=^https?:\/\/weather-data\.apple\.com\/(v1|v2)\/weather\/.*, requires-body=1, timeout=20, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Weather.js, argument=
Apple Weather Map = type=http-request, pattern=^https?:\/\/weather-map\.apple\.com\/(v1|v2)\/mapOverlay\/.*(\?.*country=CN.*), requires-body=0, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Weather.Map.js, argument=
# > Response Geo Services to USæ£€æµ‹åœ°åŒº(gspe1-ssl.ls.apple.com)
Geo Services = type=http-request, pattern=^https?:\/\/gspe\d*-ssl\.ls\.apple\.com(\/pep\/gcc), argument=GeoCountryCode=US, requires-body=0, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Geo_Services.js
# > Redirect Apple Maps to CNæ£€æµ‹åœ°åŒº(gspe35-ssl.ls.apple.com)
(^https?:\/\/gspe\d*-ssl\.ls\.apple\.)(com|cn)(\/.*)(country_code=[A-Z]{2})(.*) $1$2$3country_code=CN$5 header
(^https?:\/\/gspe\d*-ssl\.ls\.apple\.)(com|cn)(\/.*)(environment=[a-z/-]{4,})(.*) $1$2$3environment=prod-cn$5 header
# > å…¨é¢è‡ªå®šä¹‰ã€ŒSiriä¸æœç´¢ã€çš„åŠŸèƒ½(api*.smoot.apple.com, api*.smoot.apple.cn)
# Bag (iOS/macOS)
Siri Suggestions Service = type=http-request, pattern=^https?:\/\/api.*\.smoot\.apple\.(com|cn)\/bag\?(.*), requires-body=0, timeout=5, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Siri.request.js, argument=
Siri Suggestions Service = type=http-response, pattern=^https?:\/\/api.*\.smoot\.apple\.(com|cn)\/bag\?(.*), requires-body=1, timeout=10, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Siri.response.js, argument=
# Spotlight & Look Up Search (iOS/macOS)
Spotlight & Look Up Search = type=http-request, pattern=^https?:\/\/api.*\.smoot\.apple\.(com|cn)\/search\?(.*), requires-body=0, timeout=5, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Siri.request.js, argument=
Spotlight & Look Up Search = type=http-response, pattern=^https?:\/\/api.*\.smoot\.apple\.(com|cn)\/search\?(.*), requires-body=1, timeout=10, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Siri.response.js, argument=
# Siri Infomation Card (macOS)
Siri Infomation Card = type=http-request, pattern=^https?:\/\/api.*\.smoot\.apple\.(com|cn)\/card\?(.*), requires-body=0, timeout=5, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Siri.request.js, argument=
Siri Infomation Card = type=http-response, pattern=^https?:\/\/api.*\.smoot\.apple\.(com|cn)\/card\?(.*), requires-body=1, timeout=10, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Siri.response.js, argument=
# > è§£é”ï£¿TV appå…¨åŠŸèƒ½(uts-api.itunes.apple.com)
# Enable All ï£¿TV app Tabs
Apple TV = type=http-response, pattern=^https?:\/\/uts-api\.itunes\.apple\.com\/uts\/(v1|v2|v3)\/configurations\?.*, requires-body=1, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_TV.js
# ï£¿TV app Tabs, Redirect Desktop Platform to AppleTV, Redirect Sports and Kids Tabs StoreFront to US (143441)
Apple TV = type=http-request, pattern=^https?:\/\/uts-api\.itunes\.apple\.com\/uts\/(v1|v2|v3)\/canvases\/Roots\/(watchNow|tahoma_watchnow|movies|tv|sports|kids)\?.*, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_TV.js
# ï£¿TV app movies and shows and sports infomation Webs, Redirect Desktop Platform to AppleTV
Apple TV = type=http-request, pattern=^https?:\/\/uts-api\.itunes\.apple\.com\/uts\/(v1|v2|v3)\/(movies|shows|sports|sporting-events).*, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_TV.js
# ï£¿TV UpNext, Redirect Desktop Platform to AppleTV
Apple TV = type=http-request, pattern=^https?:\/\/uts-api\.itunes\.apple\.com(\/uts\/)(v1|v2|v3)\/shelves\/uts.col.UpNext.*, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_TV.js
# ï£¿TV channels, Redirect StoreFront to US (143441)
Apple TV = type=http-request, pattern=^https?:\/\/uts-api\.itunes\.apple\.com(\/uts\/)(v1|v2|v3)\/brands\?.*, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_TV.js
# ï£¿TV Live Playables, Redirect StoreFront to US (143441)
Apple TV = type=http-request, pattern=^https?:\/\/uts-api\.itunes\.apple\.com(\/uts\/)(v1|v2|v3)\/playables.*, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_TV.js
# ï£¿TV Favorites Teams web, Redirect StoreFront to US (143441)
Apple TV = type=http-request, pattern=^https?:\/\/uts-api\.itunes\.apple\.com(\/uts\/)(v1|v2|v3)\/favorites\?.*, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_TV.js
# ï£¿TV Watchlist Function, Redirect desktop Platform to iPad
Apple TV = type=http-request, pattern=^https?:\/\/uts-api\.itunes\.apple\.com(\/uts\/)(v1|v2|v3)\/watchlist.*, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_TV.js
# Enable ï£¿TV Favorites Teams Function, Redirect StoreFront to US (143441)
Apple TV = type=http-request, pattern=^https?:\/\/uts-api\.itunes\.apple\.com\/uts\/(v1|v2|v3)\/favorites\/(add|remove).*, requires-body=1, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_TV.js
# ï£¿TV Product View, no Redirect
# Apple TV = type=http-request, pattern=^https?:\/\/uts-api\.itunes\.apple\.com(\/uts\/)(v1|v2|v3)\/view\/product\/.*, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_TV.js
# > è§£é”ğŸ‡ºğŸ‡¸USåœ°åŒºçš„ï£¿Newsï¼Œæ³¨ï¼šéœ€é…åˆåŸŸåé›†ä½¿ç”¨ï¼Œä½¿ç”¨è¿‡ç¨‹ä¸­gateway.icloud.coméœ€èµ°ä»£ç†çº¿è·¯
#host= news-client.apple.com, news-client-search.apple.com, news-edge.apple.com, news-events.apple.com
Apple News = type=http-request, pattern=^https?:\/\/news-(edge|events)\.apple\.com\/(v1\/configs|analyticseventsv2\/async).*, requires-body=1, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_News.js
Apple News = type=http-request, pattern=^https?:\/\/news-(client-search)\.apple\.com\/(v1\/search\?).*, requires-body=0, script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_News.js

# > JD App æ˜¾ç¤ºå†å²ä»·æ ¼ by yichahucha&Small
jd_price.js = type=http-response,requires-body=1,pattern=^https?:\/\/api\.m\.jd\.com\/client\.action\?functionId=(wareBusiness|serverConfig|basicConfig),script-path=https://raw.githubusercontent.com/githubdulong/Script/master/jd_tb_price.js

# > Taobao App æ˜¾ç¤ºå†å²ä»·æ ¼ by yichahucha ä¿®æ”¹Surgeè¯­æ³• by Small
tb_price.js = type=http-request,requires-body=1,pattern=^http:\/\/.+\/amdc\/mobileDispatch,script-path=https://raw.githubusercontent.com/githubdulong/Script/master/jd_tb_price.js
tb_price.js = type=http-response,requires-body=1,pattern=^https?:\/\/trade-acs\.m\.taobao\.com\/gw\/mtop\.taobao\.detail\.getdetail,script-path=https://raw.githubusercontent.com/githubdulong/Script/master/jd_tb_price.js

[Header Rewrite]
# > çŸ¥ä¹ï¼ˆéƒ¨åˆ†æ›¿æ¢ä¸ºæ‰‹æœºç™¾åº¦ Quark çš„ User-Agentï¼‰
http-request ^https?:\/\/www\.zhihu\.com header-replace-regex User-Agent .+iPhone.+ "Mozilla/5.0 (iPhone; CPU iPhone OS 13_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1.1 Mobile/15E148 Safari/16C50 Quark/604.1 T7/10.3 SearchCraft/2.6.3 (Baidu; P1 8.0.0)"

# > ç™¾åº¦ï¼ˆå…¨ç«™æ›¿æ¢ä¸ºæ‰‹æœºç™¾åº¦ Quark çš„ User-Agentï¼‰
http-request ^https?:\/\/(?!d\.pcs).*(?<!map)\.baidu\.com header-replace-regex User-Agent .+iPhone.+ "Mozilla/5.0 (iPhone; CPU iPhone OS 13_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1.1 Mobile/15E148 Safari/16C50 Quark/604.1 T7/10.3 SearchCraft/2.6.3 (Baidu; P1 8.0.0)"

# > è‹¹æœå¤©æ°”ç›¸å…³
http-request ^https?:\/\/weather-data\.apple\.com\/(v1|v2)\/weather\/.* header-del If-None-Match

[URL Rewrite]
# >> IGN China to IGN Global(gn.xn--fiqs8s)
^https?://(www.)?ign\.xn--fiqs8s/ https://cn.ign.com/ccpref/us 302
# > Bilibili SEA è§£é™¤ SIM å¡åœ°åŒºé™åˆ¶(app.biliintl.com)
(^https?:\/\/app\.biliintl\.com\/intl\/.+)(&sim_code=\d+)(.+) $1$3 302

[MITM]
hostname = %APPEND% boxer.baidu.com, www.zhihu.com, weather-data.apple.com, weather-map.apple.com, gspe1-ssl.ls.apple.com, api*.smoot.apple.com, api*.smoot.apple.cn, gspe35-ssl.ls.apple.com, uts-api.itunes.apple.com, news-client.apple.com, news-client-search.apple.com, news-edge.apple.com, news-events.apple.com, gn.xn--fiqs8s, api.m.jd.com, trade-acs.m.taobao.com, app.biliintl.com




# > æ¨¡å—è®¢é˜…(å•ç‹¬æ·»åŠ )
//çˆ¬è™«å¤å†™å»å¹¿å‘Š https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rewrite/Surge/Advertising/Advertising.sgmodule
//ä»€ä¹ˆå€¼å¾—ä¹°å»å¹¿å‘Š https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/script/smzdm/smzdm_remove_ads.sgmodule
//è´´å§å»é™¤å¹¿å‘Šhttps://raw.githubusercontent.com/app2smile/rules/master/module/tieba.sgmodule
//spotifyè§£é”https://raw.githubusercontent.com/app2smile/rules/master/module/spotify.module
//å“”å“©å“”å“©å»å¹¿å‘Šhttps://raw.githubusercontent.com/app2smile/rules/master/module/bilibili.sgmodule
//SiriåŒºåŸŸè§£é”https://raw.githubusercontent.com/VirgilClyne/iRingo/main/sgmodule/Siri_Suggestions.sgmodule
//äº¬ä¸œè¾…åŠ©ç™»é™†https://raw.githubusercontent.com/Fokit/Quantumult-X/main/rewrite/jd_login_help2.sgmodule
//äº¬ä¸œåŠ©æ‰‹(æ³¨å…¥å¼éœ€keyï¼‰https://raw.githubusercontent.com/githubdulong/Script/master/jdHelper.sgmodule
//äº¬ä¸œè”ç›Ÿè½¬é“¾ï¼ˆè”ç›Ÿã€åŠ©æ‰‹äºŒé€‰ä¸€ï¼‰https://raw.githubusercontent.com/githubdulong/Script/master/Surge/jdapp_to_union.sgmodule
//æµè§ˆå™¨æœç´¢https://raw.githubusercontent.com/githubdulong/Script/master/Surge/Q-Search_All_in_one.sgmodule
//çŸ¥ä¹å»å¹¿å‘Šhttps://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/script/zhihu/zhihu_plus.sgmodule
//äº¬ä¸œåŠè‡ªåŠ¨é”€å¡https://raw.githubusercontent.com/githubdulong/Script/master/Jd_unbindCard.sgmodule
//äº¬ä¸œæ·˜å®æ¯”ä»·https://raw.githubusercontent.com/githubdulong/Script/master/jd_price2.sgmodule
//äº¬è±†https://cdn.jsdelivr.net/gh/tttwwy/surge/jd_price.sgmodule